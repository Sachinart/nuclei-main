id: CVE-2025-55182-simple

info:
  name: React Server Components - RCE Detection (HTTP Only)
  author: ChiragArtani
  severity: critical
  tags: cve,cve2025,react,rce,nextjs

variables:
  request-id: "{{to_lower(rand_text_alphanumeric(8))}}"
  nextjs-html: "{{rand_text_alphanumeric(21)}}"
  next-action: "{{to_lower(rand_text_alphanumeric(1))}}"

http:
  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Next-Action: {{next-action}}
        X-Nextjs-Request-Id: {{request-id}}
        Next-Router-State-Tree: %5B%22%22%2C%7B%22children%22%3A%5B%22__PAGE__%22%2C%7B%7D%2Cnull%2Cnull%5D%7D%2Cnull%2Cnull%2Ctrue%5D
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad
        X-Nextjs-Html-Request-Id: {{nextjs-html}}

        ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
        Content-Disposition: form-data; name="1"

        {}
        ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
        Content-Disposition: form-data; name="0"

        ["$1:aa:aa"]
        ------WebKitFormBoundaryx8jO2oVc6SWP3Sad--

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 500'
          - 'contains(body, "E{\"digest\":")'
        condition: and
